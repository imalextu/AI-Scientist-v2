<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Management Paper Agent</title>
    <link rel="stylesheet" href="/ui/styles.css" />
  </head>
  <body>
    <div class="background-layer" aria-hidden="true"></div>

    <main class="shell">
      <header class="hero">
        <p class="kicker">Local Workflow Console</p>
        <h1>管理学论文生成器</h1>
        <p class="subtitle">编辑 config 与 topic，点击生成后按阶段实时查看内容。</p>
      </header>

      <div class="layout">
        <section class="panel controls">
          <h2>输入配置</h2>

          <div class="field">
            <label for="titleInput">论文题目（可选）</label>
            <input id="titleInput" type="text" placeholder="例如：数字化转型对组织韧性的影响研究" />
          </div>

          <div class="field">
            <label for="configInput">config.yaml</label>
            <textarea id="configInput" spellcheck="false"></textarea>
          </div>

          <div class="field">
            <label for="topicInput">topic 内容</label>
            <textarea id="topicInput" spellcheck="false"></textarea>
          </div>

          <div class="actions">
            <button id="startBtn" type="button">生成</button>
            <button id="stopBtn" type="button" class="ghost" disabled>停止任务</button>
          </div>

          <div class="field cache-field">
            <label for="cacheSelect">缓存列表</label>
            <div class="inline-actions">
              <select id="cacheSelect"></select>
              <button id="refreshCacheBtn" type="button" class="ghost">刷新</button>
              <button id="loadCacheBtn" type="button" class="ghost">恢复缓存</button>
            </div>
            <div class="inline-actions">
              <select id="resumeStageSelect">
                <option value="literature">从 00 文献检索 开始</option>
                <option value="idea">从 01 选题设计 开始</option>
                <option value="review">从 00 文献综述 开始</option>
                <option value="outline">从 02 论文大纲 开始</option>
                <option value="paper">从 03 论文正文 开始</option>
              </select>
              <select id="resumeTargetSelect">
                <option value="same">仅运行该阶段</option>
                <option value="paper">继续到论文完成</option>
              </select>
              <button id="resumeBtn" type="button">从缓存继续运行</button>
            </div>
            <p class="hint">每个阶段右侧支持“缓存”按钮，点击后会把该阶段及之前数据保存到列表。</p>
          </div>

          <div class="field history-field">
            <label for="historyDirInput">历史输出目录（可选）</label>
            <input id="historyDirInput" type="file" webkitdirectory directory multiple />
            <p class="hint">选择单个 run 目录，例如 outputs/20260216_234256_xxx</p>
          </div>

          <p id="statusLine">状态：等待开始</p>
          <p id="pathLine">输出目录：-</p>
        </section>

        <section class="panel outputs">
          <div class="card">
            <h2>运行日志</h2>
            <pre id="logOutput"></pre>
          </div>

          <div class="card">
            <div class="card-head">
              <h2>00 文献检索 JSON</h2>
              <div class="card-actions">
                <button type="button" class="cache-btn ghost" data-cache-stage="literature">
                  缓存
                </button>
                <button
                  type="button"
                  class="copy-btn ghost"
                  data-copy-target="literatureOutput"
                  data-label-default="复制"
                  data-label-copied="已复制"
                >
                  复制
                </button>
              </div>
            </div>
            <pre id="literatureOutput"></pre>
          </div>

          <div class="card">
            <div class="card-head">
              <h2>01 选题设计 JSON</h2>
              <div class="card-actions">
                <button type="button" class="cache-btn ghost" data-cache-stage="idea">
                  缓存
                </button>
                <button
                  type="button"
                  class="copy-btn ghost"
                  data-copy-target="ideaOutput"
                  data-label-default="复制"
                  data-label-copied="已复制"
                >
                  复制
                </button>
              </div>
            </div>
            <pre id="ideaOutput"></pre>
          </div>

          <div class="card">
            <div class="card-head">
              <h2>00 文献综述 Markdown</h2>
              <div class="card-actions">
                <button type="button" class="cache-btn ghost" data-cache-stage="review">
                  缓存
                </button>
                <button
                  type="button"
                  class="copy-btn ghost"
                  data-copy-target="reviewOutput"
                  data-label-default="复制"
                  data-label-copied="已复制"
                >
                  复制
                </button>
              </div>
            </div>
            <pre id="reviewOutput"></pre>
          </div>

          <div class="card">
            <div class="card-head">
              <h2>02 论文大纲 JSON</h2>
              <div class="card-actions">
                <button type="button" class="cache-btn ghost" data-cache-stage="outline">
                  缓存
                </button>
                <button
                  type="button"
                  class="copy-btn ghost"
                  data-copy-target="outlineOutput"
                  data-label-default="复制"
                  data-label-copied="已复制"
                >
                  复制
                </button>
              </div>
            </div>
            <pre id="outlineOutput"></pre>
          </div>

          <div class="card">
            <div class="card-head">
              <h2>02a 对策支持 JSON</h2>
              <div class="card-actions">
                <button
                  type="button"
                  class="copy-btn ghost"
                  data-copy-target="policySupportOutput"
                  data-label-default="复制"
                  data-label-copied="已复制"
                >
                  复制
                </button>
              </div>
            </div>
            <pre id="policySupportOutput"></pre>
          </div>

          <div class="card">
            <div class="card-head">
              <h2>03 论文正文 Markdown</h2>
              <div class="card-actions">
                <button type="button" class="cache-btn ghost" data-cache-stage="paper">
                  缓存
                </button>
                <button
                  type="button"
                  class="copy-btn ghost"
                  data-copy-target="paperOutput"
                  data-label-default="复制"
                  data-label-copied="已复制"
                >
                  复制
                </button>
              </div>
            </div>
            <pre id="paperOutput"></pre>
          </div>
        </section>
      </div>
    </main>

    <script src="/ui/app.js" defer></script>
  </body>
</html>
